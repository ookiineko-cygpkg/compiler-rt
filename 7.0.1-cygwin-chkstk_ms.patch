--- origsrc/compiler-rt-7.0.1.src/lib/builtins/CMakeLists.txt	2018-07-30 14:18:59.000000000 -0400
+++ src/compiler-rt-7.0.1.src/lib/builtins/CMakeLists.txt	2019-05-07 16:55:30.615444600 -0400
@@ -241,11 +241,11 @@ if (NOT MSVC)
   filter_builtin_sources(x86_64_SOURCES EXCLUDE x86_64_SOURCES "${x86_64_SOURCES};${GENERIC_SOURCES}")
   set(x86_64h_SOURCES ${x86_64_SOURCES})
 
+  if (WIN32 OR CYGWIN)
+    set(x86_64_SOURCES ${x86_64_SOURCES} x86_64/chkstk.S)
+  endif()
   if (WIN32)
-    set(x86_64_SOURCES
-        ${x86_64_SOURCES}
-        x86_64/chkstk.S
-        x86_64/chkstk2.S)
+    set(x86_64_SOURCES ${x86_64_SOURCES} x86_64/chkstk2.S)
   endif()
 
   set(i386_SOURCES
@@ -265,11 +265,11 @@ if (NOT MSVC)
       i386/umoddi3.S)
   filter_builtin_sources(i386_SOURCES EXCLUDE i386_SOURCES "${i386_SOURCES};${GENERIC_SOURCES}")
 
+  if (WIN32 OR CYGWIN)
+    set(i386_SOURCES ${i386_SOURCES} i386/chkstk.S)
+  endif()
   if (WIN32)
-    set(i386_SOURCES
-        ${i386_SOURCES}
-        i386/chkstk.S
-        i386/chkstk2.S)
+    set(i386_SOURCES ${i386_SOURCES} i386/chkstk2.S)
   endif()
 else () # MSVC
   # Use C versions of functions when building on MSVC
